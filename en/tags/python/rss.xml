<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Python on yshalsager</title><link>https://yshalsager.com/en/tags/python/</link><description>Latest posts from in Python yshalsager</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><copyright>Copyright Â© 2013-{year} yshalsager. All Rights Reserved.</copyright><lastBuildDate>Mon, 28 Sep 2020 00:00:00 +0000</lastBuildDate><atom:link href="https://yshalsager.com/en/tags/python/rss.xml" rel="self" type="application/rss+xml"/><item><title>Debugging and fixing Selenium's send_keys() wrong text input</title><link>https://yshalsager.com/en/posts/debugging-and-fixing-selenium-send-keys-wrong-text-input/</link><pubDate>Mon, 28 Sep 2020 00:00:00 +0000</pubDate><guid>https://yshalsager.com/en/posts/debugging-and-fixing-selenium-send-keys-wrong-text-input/</guid><description>&lt;p>&lt;em>There are many kinds of bugs you may face while programming, but without a doubt, ghost bugs are the worse!&lt;/em>&lt;/p>
&lt;p>I recently faced a weird problem while working on a freelance &lt;a href="https://www.selenium.dev/" target="_blank" rel="noopener noreferrer">Selenium&lt;i class="fas fa-external-link-square-alt ms-1">&lt;/i>&lt;/a> (A portable framework for testing web applications) project in Python which is: &lt;a href="https://selenium-python.readthedocs.io/api.html?highlight=execute_script#selenium.webdriver.remote.webelement.WebElement.send_keys" target="_blank" rel="noopener noreferrer">send_keys&lt;i class="fas fa-external-link-square-alt ms-1">&lt;/i>&lt;/a> method is sending random wrong input. Here are the details of the problem, how did I debug it, and how I managed to fix after hours of investigating!&lt;/p>
&lt;p>I have been working on a freelance Selenium web automation and scraping project and we need to move the script to a better Linux server that runs Ubuntu 20.04. After migrating I found out that Selenium text input became so random (although it works perfectly on local PCs). For example, spaces are no longer sent, numbers are mixed, some characters are dropped, and so forth.&lt;/p>
&lt;p>I started to debug with &lt;a href="https://python.org" target="_blank" rel="noopener noreferrer">Python&lt;i class="fas fa-external-link-square-alt ms-1">&lt;/i>&lt;/a>&amp;rsquo;s &lt;a href="https://docs.python.org/3/library/logging.html" target="_blank" rel="noopener noreferrer">logging&lt;i class="fas fa-external-link-square-alt ms-1">&lt;/i>&lt;/a> standard module, but the log said that the correct input was being entered, which is logical since no code changes happened. Then, I tried to see if there&amp;rsquo;s something wrong with &lt;a href="https://chromedriver.chromium.org/" target="_blank" rel="noopener noreferrer">chromedriver&lt;i class="fas fa-external-link-square-alt ms-1">&lt;/i>&lt;/a> that being used to automate Google Chrome browser, but again, version on the old and new servers was the same. I have also tried on another (third) server that runs Ubuntu 18.04 and the same bug occurred. It&amp;rsquo;s Google and &lt;a href="https://stackoverflow.com" target="_blank" rel="noopener noreferrer">stackoverflow&lt;i class="fas fa-external-link-square-alt ms-1">&lt;/i>&lt;/a> time! I searched our beloved websites to see if any people faced this problem besides me. I found many results from 6 years ago till 5 months ago. The most interesting one was a &lt;a href="https://chromedriver.chromium.org/" target="_blank" rel="noopener noreferrer">chromedriver&lt;i class="fas fa-external-link-square-alt ms-1">&lt;/i>&lt;/a>&amp;rsquo;s &lt;a href="https://bugs.chromium.org/p/chromedriver/issues/detail?id=1771" target="_blank" rel="noopener noreferrer">bug&lt;i class="fas fa-external-link-square-alt ms-1">&lt;/i>&lt;/a> that got closed with &lt;code>WontFix&lt;/code> status. This bug aside, the suggested solutions were:&lt;/p>
&lt;ul>
&lt;li>Using &lt;a href="https://selenium-python.readthedocs.io/api.html?highlight=WebElement#selenium.webdriver.remote.webelement.WebElement.clear" target="_blank" rel="noopener noreferrer">clear()&lt;i class="fas fa-external-link-square-alt ms-1">&lt;/i>&lt;/a> method of the &lt;a href="https://selenium-python.readthedocs.io/api.html?highlight=WebElement#module-selenium.webdriver.remote.webelement" target="_blank" rel="noopener noreferrer">WebElement&lt;i class="fas fa-external-link-square-alt ms-1">&lt;/i>&lt;/a> before sending the text input.&lt;/li>
&lt;li>Clicking the text box before sending keys.&lt;/li>
&lt;li>Using &lt;a href="https://selenium-python.readthedocs.io/api.html?highlight=execute_script#webdriver-api" target="_blank" rel="noopener noreferrer">WebDriver&lt;i class="fas fa-external-link-square-alt ms-1">&lt;/i>&lt;/a>&amp;rsquo;s &lt;a href="https://selenium-python.readthedocs.io/api.html?highlight=execute_script#selenium.webdriver.remote.webdriver.WebDriver.execute_script" target="_blank" rel="noopener noreferrer">execute_script()&lt;i class="fas fa-external-link-square-alt ms-1">&lt;/i>&lt;/a> method to execute JavaScript code that modifies the value of the input form to the required text.&lt;/li>
&lt;li>Using &lt;a href="https://docs.python.org/3/library/time.html?highlight=sleep#time.sleep" target="_blank" rel="noopener noreferrer">sleep&lt;i class="fas fa-external-link-square-alt ms-1">&lt;/i>&lt;/a> from &lt;code>time&lt;/code> standard module to wait for seconds between two &lt;code>send_keys()&lt;/code> calls.&lt;/li>
&lt;li>Changing the server&amp;rsquo;s keyboard layout to &lt;code>US&lt;/code>.&lt;/li>
&lt;li>Using &lt;a href="https://github.com/asweigart/pyperclip/" target="_blank" rel="noopener noreferrer">pyperclip&lt;i class="fas fa-external-link-square-alt ms-1">&lt;/i>&lt;/a> module to paste the text into the browser directly.&lt;/li>
&lt;/ul>
&lt;p>But surprisingly, none of the mentioned solutions above did it, so I gave up and planned to switch to Firefox&amp;rsquo;s &lt;a href="https://github.com/mozilla/geckodriver" target="_blank" rel="noopener noreferrer">geckodriver&lt;i class="fas fa-external-link-square-alt ms-1">&lt;/i>&lt;/a> in the next day.&lt;/p>
&lt;p>After starting to add &lt;code>geckodriver&lt;/code> support, I decided to search for a solution again since the code works &lt;strong>perfectly&lt;/strong> on the PC. While reading stackoverflow&amp;rsquo;s solutions my eyes caught a very interesting &lt;a href="https://stackoverflow.com/a/23411005" target="_blank" rel="noopener noreferrer">answer&lt;i class="fas fa-external-link-square-alt ms-1">&lt;/i>&lt;/a>:&lt;/p>
&lt;blockquote>
&lt;p>I also experienced this problem when connecting to a VM using VNC and then running the Selenium test that way.
The VNC was actually the one dropping characters. Once I moved to a direct connection to the VM using the VirtualBox console&amp;hellip; it worked fine.&lt;/p>
&lt;/blockquote>
&lt;p>This sounded very logical to me, so I quickly check what is the used &lt;a href="https://en.wikipedia.org/wiki/Virtual_Network_Computing" target="_blank" rel="noopener noreferrer">VNC&lt;i class="fas fa-external-link-square-alt ms-1">&lt;/i>&lt;/a> on the new server (Ubuntu 20.04) and the third server (Ubuntu 18.04). It was &lt;a href="https://www.tightvnc.com/" target="_blank" rel="noopener noreferrer">TightVNC&lt;i class="fas fa-external-link-square-alt ms-1">&lt;/i>&lt;/a>. The old server VNC was available externally from the service provider so I couldn&amp;rsquo;t check what does it use.&lt;/p>
&lt;p>After more quick googling I found out that &lt;a href="https://tigervnc.org/" target="_blank" rel="noopener noreferrer">TigerVNC&lt;i class="fas fa-external-link-square-alt ms-1">&lt;/i>&lt;/a> should be a good alternative to the current VNC server. Using apt (a package manager for Debian, Ubuntu, and related Linux distributions), I installed &lt;code>tigervnc-standalone-server tigervnc-common tigervnc-xorg-extension&lt;/code> packages and boom! it worked like a charm.&lt;/p>
&lt;p>It was a very weird problem that occurred out of the blue and I took a very long time to figure it out and fix it. Hopes this post helps you if came here for fixing this problem!&lt;/p></description></item></channel></rss>